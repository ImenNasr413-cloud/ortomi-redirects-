<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <title>Pagamento riuscito</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script>
    window.onload = function () {
      const params = new URLSearchParams(window.location.search);
      const paymentId = params.get("paymentId");
      const payerId = params.get("PayerID"); // PayPal l’envoie bien en majuscule

      if (paymentId && payerId) {
        const redirectUrl = `ortomi://paypal-success?paymentId=${paymentId}&payerId=${payerId}`;
        console.log("✅ URL di reindirizzamento:", redirectUrl);

        // Affiche un message sur la page avant redirection
        document.body.innerHTML += "<p style='color:blue;'>⏳ Reindirizzamento tra 5 secondi...</p>";

        // Attend 5 secondes avant de rediriger vers l'application
        setTimeout(() => {
          window.location.href = redirectUrl;
        }, 5000);
      } else {
        document.body.innerHTML = "<h1>❌ Pagamento non valido</h1><p>Parametri mancanti</p>";
      }
    };
  </script>
</head>
<body>
  <h1>✅ Pagamento effettuato con successo</h1>
  <p>Stai per essere reindirizzato all’app Ortomi...</p>
</body>
</html>

